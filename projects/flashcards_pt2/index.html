<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-01NSK99TZ0"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-01NSK99TZ0");</script> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Flashcards Pt.2 | Aven Arlington</title> <meta name="author" content="Aven Arlington"> <meta name="description" content="Simple CLI utility that quizzes a user on custom clue-answer pairs"> <meta name="keywords" content="Rust programming language, Rust tutorials, Rust graphics programming, Rust utilities, Rust projects, Rust examples, Rust game development tutorials, Rust embedded systems programming guide, Graphics programming using Rust language, Embedded development with Rust, IoT programming in Rust, Video game design in Rust, IoT projects with Rust programming, Circuit design, portfolio-website, tutorial, "> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://aven-arlington.github.io/projects/flashcards_pt2/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Aven </span>Arlington</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">GitHub Repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">Resume</a> </li> <li class="nav-item "> <a class="nav-link" href="/cookoffs/">Cook-off</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Flashcards Pt.2</h1> <p class="post-description">Simple CLI utility that quizzes a user on custom clue-answer pairs</p></header> <article> <h2 id="topics-covered">Topics Covered</h2> <ul> <li>Data deserialization</li> <li>Algorithms</li> <li>Random number generation</li> </ul> <h2 id="tldr">TLDR</h2> <p><a href="#try-it-out">Try it out in a sandbox…</a><br> <a href="https://github.com/aven-arlington/flashcards-cli/tree/project-functionality" rel="external nofollow noopener" target="_blank">Source code for this project post…</a><br> <a href="https://github.com/aven-arlington/flashcards-cli" rel="external nofollow noopener" target="_blank">Completed Project…</a></p> <h2 id="background">Background</h2> <p>This is the second part of a multi-part series that started with <a href="/projects/flashcards_pt1/">Flashcards Pt.1</a>.</p> <p>Now that I have a basic layout for the application and a general idea of where I want the different building blocks to go I will start to add functionality. I will start with a configuration file with basic data to test against and deserialize that into usable Rust objects. From there the engine can create a deck of flashcards and shuffle them before presenting them to the user.</p> <h2 id="lets-tackle-the-problem">Let’s Tackle the Problem</h2> <h3 id="defining-the-data">Defining the Data</h3> <p>Note: I am choosing to use a YAML file format because I prefer the semantics over JSON. This decision is purely subjective and either format can be used with virtually zero changes to the underlying code.</p> <p>I consider what information a typical flashcard would contain and create a <code class="language-plaintext highlighter-rouge">struct</code> to represent a <code class="language-plaintext highlighter-rouge">Flashcard</code> object. Of course the most important information on a flashcard is the clue-answer pair so fields are created for each. I also intend on the game taking the difficulty of the clue-answer pair into consideration so that the player can get a sense of accomplishment as the questions get harder. I want the configuration to be easy for the user which is in conflict with requiring a difficulty for each card. To accomplish both I will create a <code class="language-plaintext highlighter-rouge">level</code> field to represent the difficulty and make it optional. As discussed in Pt.1, the <code class="language-plaintext highlighter-rouge">Flashcard</code> will need to be public so it can be used everywhere. Finally, I implement a <code class="language-plaintext highlighter-rouge">new</code> function to instantiate them.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// flashcard.rs</span>
<span class="k">pub</span> <span class="k">struct</span> <span class="n">FlashCard</span> <span class="p">{</span>
    <span class="k">pub</span> <span class="n">clue_side</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="k">pub</span> <span class="n">answer_side</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="k">pub</span> <span class="n">level</span><span class="p">:</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="nb">u32</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">impl</span> <span class="n">FlashCard</span> <span class="p">{</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">new</span><span class="p">(</span>
        <span class="n">clue_side</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="n">answer_side</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="n">level</span><span class="p">:</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="nb">u32</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="p">)</span> <span class="k">-&gt;</span> <span class="k">Self</span> <span class="p">{</span>
        <span class="k">Self</span> <span class="p">{</span>
            <span class="n">clue_side</span><span class="p">,</span>
            <span class="n">answer_side</span><span class="p">,</span>
            <span class="n">level</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>As features are added to the application, I will need more than a <code class="language-plaintext highlighter-rouge">Vec&lt;Flashcard&gt;</code> to properly hold configuration information. Right now I know that I want to define how many attempts a player can make on a card before the answer is wrong and the correct answer is displayed. So I add these concerns together in a <code class="language-plaintext highlighter-rouge">Config</code> object that also has to be public for the entire application to use.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// config.rs</span>
<span class="k">pub</span> <span class="k">struct</span> <span class="n">Config</span> <span class="p">{</span>
    <span class="k">pub</span> <span class="n">attempts_before_wrong</span><span class="p">:</span> <span class="nb">usize</span><span class="p">,</span>
    <span class="k">pub</span> <span class="n">cards</span><span class="p">:</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">FlashCard</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div> <p>Now that I have defined what data is required, the YAML file can be generated with some sample data.</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flashcards.yaml</span>
<span class="na">attempts_before_wrong</span><span class="pi">:</span> <span class="m">2</span>

<span class="na">cards</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">clue_side</span><span class="pi">:</span> <span class="s">Move cursor left</span>
    <span class="na">answer_side</span><span class="pi">:</span> <span class="s2">"</span><span class="s">h"</span>
    <span class="na">level</span><span class="pi">:</span> <span class="m">0</span>

  <span class="pi">-</span> <span class="na">clue_side</span><span class="pi">:</span> <span class="s">Move cursor down</span>
    <span class="na">answer_side</span><span class="pi">:</span> <span class="s2">"</span><span class="s">j"</span>
    <span class="na">level</span><span class="pi">:</span> <span class="m">0</span>
<span class="c1"># ... and so on</span>
</code></pre></div></div> <h3 id="deserialization">Deserialization</h3> <p>Importing the data from the YAML file and into <code class="language-plaintext highlighter-rouge">Vec&lt;Flashcard&gt;</code> is surprisingly easy with the <code class="language-plaintext highlighter-rouge">serde</code> crate doing all the heavy lifting. Adding the <code class="language-plaintext highlighter-rouge">serde</code> crate is done in the <code class="language-plaintext highlighter-rouge">Cargo.toml</code> file like so:</p> <div class="language-toml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Cargo.toml</span>
<span class="c"># Package Declaration...</span>

<span class="nn">[dependencies]</span>
<span class="nn">serde</span> <span class="o">=</span> <span class="p">{</span> <span class="py">version</span> <span class="p">=</span> <span class="s">"*"</span><span class="p">,</span> <span class="py">features</span> <span class="p">=</span> <span class="p">[</span><span class="s">"derive"</span><span class="p">]</span> <span class="p">}</span>
<span class="py">serde_yaml</span> <span class="p">=</span> <span class="s">"*"</span>
</code></pre></div></div> <p>Both ````Config<code class="language-plaintext highlighter-rouge">and</code>Flashcard<code class="language-plaintext highlighter-rouge">can be used with</code>serde<code class="language-plaintext highlighter-rouge">simply by deriving the</code>Deserialize``` trait.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Config used as example. Flashcard would also need to derive Deserialize</span>
<span class="nd">#[derive(Deserialize)]</span>
<span class="k">pub</span> <span class="k">struct</span> <span class="n">Config</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>
</code></pre></div></div> <p>Finally, I am ready to perform the actual data import. This is accomplished with a quick check to be sure that the file exists at the root of the project and returning an error if something goes wrong.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// config.rs</span>
<span class="k">fn</span> <span class="nf">check_default_path</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="nb">Result</span><span class="o">&lt;</span><span class="n">PathBuf</span><span class="p">,</span> <span class="o">&amp;</span><span class="k">'static</span> <span class="nb">str</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">path_buffer</span><span class="p">:</span> <span class="n">PathBuf</span> <span class="o">=</span> <span class="nn">env</span><span class="p">::</span><span class="nf">current_dir</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">();</span>
    <span class="n">path_buffer</span><span class="nf">.push</span><span class="p">(</span><span class="s">"flashcards.yaml"</span><span class="p">);</span>
    <span class="k">if</span> <span class="n">path_buffer</span><span class="nf">.try_exists</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">Ok</span><span class="p">(</span><span class="n">path_buffer</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nf">Err</span><span class="p">(</span><span class="s">"The flashcards.yaml configuration file could not be found"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>The resulting <code class="language-plaintext highlighter-rouge">PathBuf</code> is used to read the YAML file into a <code class="language-plaintext highlighter-rouge">String</code> and passed to serde’s <code class="language-plaintext highlighter-rouge">from_str</code> function which performs the YAML deserialization and returns a <code class="language-plaintext highlighter-rouge">Config</code> object or an Error. I do a quick check for the basic validity of the <code class="language-plaintext highlighter-rouge">Config</code> object to ensure it should be usable by the game engine.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// config.rs</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">build</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="nb">Result</span><span class="o">&lt;</span><span class="n">Config</span><span class="p">,</span> <span class="o">&amp;</span><span class="k">'static</span> <span class="nb">str</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">file_path</span> <span class="o">=</span> <span class="nn">Config</span><span class="p">::</span><span class="nf">check_default_path</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">();</span>
    <span class="k">let</span> <span class="n">file_data</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span><span class="nf">.expect</span><span class="p">(</span><span class="s">"Unable to read config file"</span><span class="p">)</span>
    <span class="k">let</span> <span class="n">conf</span><span class="p">:</span> <span class="n">Config</span> <span class="o">=</span>
        <span class="nn">serde_yaml</span><span class="p">::</span><span class="nf">from_str</span><span class="p">(</span><span class="n">file_data</span><span class="nf">.as_str</span><span class="p">())</span><span class="nf">.expect</span><span class="p">(</span><span class="s">"Unable to parse data string"</span><span class="p">)</span>
    <span class="nd">assert!</span><span class="p">(</span><span class="n">conf</span><span class="py">.attempts_before_wrong</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"Invalid attempts_before_wrong"</span><span class="p">);</span>
    <span class="nd">assert!</span><span class="p">(</span><span class="o">!</span><span class="n">conf</span><span class="py">.cards</span><span class="nf">.is_empty</span><span class="p">(),</span> <span class="s">"No FlashCards in config file"</span><span class="p">);</span>
    <span class="nf">Ok</span><span class="p">(</span><span class="n">conf</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div> <p>That’s it for deserializing the data from the YAML file. Now to create something useful from it.</p> <h3 id="deck-building-algorithm">Deck Building Algorithm</h3> <p>User supplied data is messy and prone to have errors. In order to build a deck of <code class="language-plaintext highlighter-rouge">Flashcards</code> I have to assume that not all cards will have an assigned difficulty and that if they do, they can be any value, in any order, and non-sequential. These assumptions are tough to work with if allowed to be distributed throughout the codebase. Instead, I want to tackle them in one place, when the <code class="language-plaintext highlighter-rouge">Deck</code> is constructed so that the rest of the application can be assured of working with clean data.</p> <p>The first step toward clean data is having the <code class="language-plaintext highlighter-rouge">Vec&lt;Flashcard&gt;</code> be sorted by the difficulty level. Adding a few traits to <code class="language-plaintext highlighter-rouge">Flashcard</code> will care of that. I add the <code class="language-plaintext highlighter-rouge">Eq</code> trait to automatically implement the equality operator when comparing <code class="language-plaintext highlighter-rouge">Flashcard</code> objects. Once that is in place, implementations are created for <code class="language-plaintext highlighter-rouge">Ord</code>, <code class="language-plaintext highlighter-rouge">PartialOrd</code>, and <code class="language-plaintext highlighter-rouge">PartialEq</code> that use the <code class="language-plaintext highlighter-rouge">level</code> field for the comparisons. I also want <code class="language-plaintext highlighter-rouge">Flashcard</code> objects to be easily passed around so I throw in the <code class="language-plaintext highlighter-rouge">Clone</code> trait for good measure.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// flashcard.rs</span>
<span class="nd">#[derive(Deserialize,</span> <span class="nd">Default,</span> <span class="nd">Debug,</span> <span class="nd">Eq,</span> <span class="nd">Clone)]</span>
<span class="k">pub</span> <span class="k">struct</span> <span class="n">FlashCard</span> <span class="p">{</span><span class="o">...</span><span class="p">}</span>

<span class="k">impl</span> <span class="nb">Ord</span> <span class="k">for</span> <span class="n">FlashCard</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">cmp</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">Self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">Ordering</span> <span class="p">{</span>
        <span class="k">self</span><span class="py">.level</span><span class="nf">.cmp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">other</span><span class="py">.level</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">impl</span> <span class="nb">PartialOrd</span> <span class="k">for</span> <span class="n">FlashCard</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">partial_cmp</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">Self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="n">Ordering</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="nf">Some</span><span class="p">(</span><span class="k">self</span><span class="nf">.cmp</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">impl</span> <span class="nb">PartialEq</span> <span class="k">for</span> <span class="n">FlashCard</span> <span class="p">{</span>
    <span class="k">fn</span> <span class="nf">eq</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">Self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">bool</span> <span class="p">{</span>
        <span class="k">self</span><span class="py">.level</span> <span class="o">==</span> <span class="n">other</span><span class="py">.level</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Now a <code class="language-plaintext highlighter-rouge">Vec&lt;Flashcard&gt;</code> can be sorted according to the difficulty of the cards so the first thing I do when building a <code class="language-plaintext highlighter-rouge">Deck</code> is exactly that.</p> <p>I create a <code class="language-plaintext highlighter-rouge">struct</code> that is meant to be a logical representation of a <code class="language-plaintext highlighter-rouge">Deck</code> of cards. Naturally it will contain some type of collection of <code class="language-plaintext highlighter-rouge">Flashcards</code> but which one is best suited for my needs?<br> Players will be discouraged if the first few random cards shown to them are all tough. I want the game to ramp up from the easiest (level == 0) cards to more difficult ones so that a player experiences a natural progression of difficulty. After sorting the <code class="language-plaintext highlighter-rouge">Vec&lt;Flashcard&gt;</code> the only assumption that can be made is that the easy ones have a lower index than harder ones. I don’t know what distinct <code class="language-plaintext highlighter-rouge">level</code> values were provided by the user, if they are disjointed, or how many cards are in each level. So I will need to separate the cards into distinct levels, re-map the levels from user supplied values into a zero based consecutive range, and then add them to a collection. I chose a <code class="language-plaintext highlighter-rouge">BTreeMap</code> because I want the <code class="language-plaintext highlighter-rouge">level</code> to be an ordered set which I use as a <code class="language-plaintext highlighter-rouge">key</code>, and the corresponding value to be a <code class="language-plaintext highlighter-rouge">Vec&lt;Flashcard&gt;</code> that contains all <code class="language-plaintext highlighter-rouge">Flashcard</code> objects with that matching level.<br> The <code class="language-plaintext highlighter-rouge">BTreeMap</code> is populated by iterating over the <code class="language-plaintext highlighter-rouge">Vec&lt;Flashcard&gt;</code>, checking for a key that corresponds to the cards level with a call to <code class="language-plaintext highlighter-rouge">entry</code>, and either inserting the <code class="language-plaintext highlighter-rouge">Flashcard</code> or creating a new <code class="language-plaintext highlighter-rouge">Vec&lt;Flashcard&gt;</code> if none exists.<br> I add two helper <code class="language-plaintext highlighter-rouge">Vec&lt;u32&gt;</code> fields to keep track of the available level range after the re-map and the levels that are currently in use by the game.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// deck.rs</span>
<span class="k">pub</span> <span class="k">struct</span> <span class="n">Deck</span> <span class="p">{</span>
    <span class="n">cards</span><span class="p">:</span> <span class="n">BTreeMap</span><span class="o">&lt;</span><span class="nb">u32</span><span class="p">,</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">FlashCard</span><span class="o">&gt;&gt;</span><span class="p">,</span>
    <span class="n">hand</span><span class="p">:</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">FlashCard</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="n">available_levels</span><span class="p">:</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">u32</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="n">current_levels</span><span class="p">:</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">u32</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="n">rng</span><span class="p">:</span> <span class="n">ThreadRng</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">impl</span> <span class="n">Deck</span> <span class="p">{</span>
    <span class="k">pub</span> <span class="k">fn</span> <span class="nf">new</span><span class="p">(</span><span class="k">mut</span> <span class="n">cards_from_config</span><span class="p">:</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">FlashCard</span><span class="o">&gt;</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="n">Deck</span> <span class="p">{</span>
        <span class="n">cards_from_config</span><span class="nf">.sort</span><span class="p">();</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">cards</span><span class="p">:</span> <span class="n">BTreeMap</span><span class="o">&lt;</span><span class="nb">u32</span><span class="p">,</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">FlashCard</span><span class="o">&gt;&gt;</span> <span class="o">=</span> <span class="nn">BTreeMap</span><span class="p">::</span><span class="nf">new</span><span class="p">();</span>
        <span class="k">for</span> <span class="n">card</span> <span class="k">in</span> <span class="n">cards_from_config</span> <span class="p">{</span>
            <span class="k">let</span> <span class="n">key</span> <span class="o">=</span> <span class="n">card</span><span class="py">.level</span><span class="nf">.unwrap_or_default</span><span class="p">();</span>
            <span class="n">cards</span>
                <span class="nf">.entry</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="nf">.and_modify</span><span class="p">(|</span><span class="n">v</span><span class="p">|</span> <span class="n">v</span><span class="nf">.push</span><span class="p">(</span><span class="n">card</span><span class="nf">.clone</span><span class="p">()))</span>
                <span class="nf">.or_insert</span><span class="p">(</span><span class="nd">vec!</span><span class="p">[</span><span class="n">card</span><span class="nf">.clone</span><span class="p">()]);</span>
        <span class="p">}</span>

        <span class="k">let</span> <span class="n">available_levels</span><span class="p">:</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">u32</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">cards</span><span class="nf">.keys</span><span class="p">()</span><span class="nf">.cloned</span><span class="p">()</span><span class="nf">.collect</span><span class="p">();</span>
        <span class="k">let</span> <span class="n">current_levels</span><span class="p">:</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">u32</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="n">available_levels</span><span class="p">[</span><span class="mi">0</span><span class="p">]];</span>
        <span class="k">let</span> <span class="n">hand</span> <span class="o">=</span> <span class="nn">Vec</span><span class="p">::</span><span class="nf">new</span><span class="p">();</span>

        <span class="k">Self</span> <span class="p">{</span>
            <span class="n">cards</span><span class="p">,</span>
            <span class="n">hand</span><span class="p">,</span>
            <span class="n">available_levels</span><span class="p">,</span>
            <span class="n">current_levels</span><span class="p">,</span>
            <span class="n">rng</span><span class="p">:</span> <span class="nn">rand</span><span class="p">::</span><span class="nf">thread_rng</span><span class="p">(),</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="generate-a-random-hand-of-flashcards">Generate a Random Hand of Flashcards</h3> <p>I want the game play to be like a physical game of flashcards where an assistant draws a few cards from the prepared deck, shuffles them, and presents them to the player one by one.<br> I create a public <code class="language-plaintext highlighter-rouge">draw_hand</code> function that will update the <code class="language-plaintext highlighter-rouge">Card::hand</code> field with a new <code class="language-plaintext highlighter-rouge">Vec&lt;Flashcard&gt;</code> every round. The game starts at level == 0 but increases with time so all cards with a <code class="language-plaintext highlighter-rouge">level</code> field matching a value contained in <code class="language-plaintext highlighter-rouge">current_levels</code> are cloned into a vector temporarily. I then “shuffle” the cards with a call to <code class="language-plaintext highlighter-rouge">shuffle</code> which performs the operation in place over the cards in <code class="language-plaintext highlighter-rouge">cards_to_draw_from</code>.<br> I set the hand size to a maximum of 5 arbitrarily but if there are fewer cards than that available the lesser amount is used instead. Then I resize the <code class="language-plaintext highlighter-rouge">hand</code> to contain the cards and clone them over.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// deck.rs</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">draw_hand</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="k">self</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">cards_to_draw_from</span><span class="p">:</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">FlashCard</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nn">Vec</span><span class="p">::</span><span class="nf">new</span><span class="p">();</span>
    <span class="k">for</span> <span class="n">level</span> <span class="k">in</span> <span class="o">&amp;</span><span class="k">self</span><span class="py">.current_levels</span> <span class="p">{</span>
        <span class="n">cards_to_draw_from</span><span class="nf">.append</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="k">self</span><span class="py">.cards</span><span class="nf">.get</span><span class="p">(</span><span class="n">level</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">()</span><span class="nf">.clone</span><span class="p">());</span>
    <span class="p">}</span>
    <span class="n">cards_to_draw_from</span><span class="nf">.shuffle</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="k">self</span><span class="py">.rng</span>  
    <span class="k">self</span><span class="py">.hand</span><span class="nf">.clear</span><span class="p">();</span>
    <span class="k">let</span> <span class="n">hand_size</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">cards_to_draw_from</span><span class="nf">.len</span><span class="p">(),</span> <span class="mi">5</span>  
    <span class="k">self</span><span class="py">.hand</span><span class="nf">.resize</span><span class="p">(</span><span class="n">hand_size</span><span class="p">,</span> <span class="nn">FlashCard</span><span class="p">::</span><span class="nf">default</span><span class="p">());</span>
    <span class="k">self</span><span class="py">.hand</span>
        <span class="nf">.clone_from_slice</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cards_to_draw_from</span><span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="n">hand_size</span><span class="p">]);</span>
<span class="p">}</span>
</code></pre></div></div> <p>I add a few helper functions to the deck for showing the next card, increasing the difficulty, and moving to the next card in the hand. The <code class="language-plaintext highlighter-rouge">next_card</code> and <code class="language-plaintext highlighter-rouge">hand_count</code> functions are pretty trivial and don’t require much explaining. The <code class="language-plaintext highlighter-rouge">increase_level_pool</code> function simply scans <code class="language-plaintext highlighter-rouge">available_levels</code> for the first entry that is not contained in <code class="language-plaintext highlighter-rouge">current_levels</code> and adds it to the vector.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// deck.rs</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">next_card</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="n">FlashCard</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="k">self</span><span class="py">.hand</span><span class="nf">.pop</span><span class="p">()</span>
<span class="p">}</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">hand_count</span><span class="p">(</span><span class="o">&amp;</span><span class="k">self</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">usize</span> <span class="p">{</span>
    <span class="k">self</span><span class="py">.hand</span><span class="nf">.len</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">pub</span> <span class="k">fn</span> <span class="nf">increase_level_pool</span> <span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="k">self</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="n">level</span> <span class="k">in</span> <span class="o">&amp;</span><span class="k">self</span><span class="py">.available_levels</span> <span class="p">{</span>
        <span class="k">if</span> <span class="k">self</span><span class="py">.current_levels</span><span class="nf">.contains</span><span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nd">println!</span><span class="p">(</span><span class="s">"Adding level {} to the deck"</span><span class="p">,</span> <span class="n">level</span><span class="p">);</span>
        <span class="k">self</span><span class="py">.current_levels</span><span class="nf">.push</span><span class="p">(</span><span class="o">*</span><span class="n">level</span><span class="p">);</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="the-game-engine">The Game Engine</h3> <p>The “game engine” consists of a public function named <code class="language-plaintext highlighter-rouge">run</code> and two private functions named <code class="language-plaintext highlighter-rouge">show_card</code> and <code class="language-plaintext highlighter-rouge">get_input</code> whose functionality is self evident.<br> The <code class="language-plaintext highlighter-rouge">run</code> function contains the main game loop which builds a <code class="language-plaintext highlighter-rouge">Deck</code> of cards as defined in the <code class="language-plaintext highlighter-rouge">Config</code>. It then prints a welcome message and instructions before drawing a hand of cards and showing them to the user one by one. When <code class="language-plaintext highlighter-rouge">deck.next_card</code> returns none, the hand is finished and the difficult is increased.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// engine.rs</span>
<span class="k">pub</span> <span class="k">fn</span> <span class="nf">run</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="k">crate</span><span class="p">::</span><span class="n">Config</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Result</span><span class="o">&lt;</span><span class="p">(),</span> <span class="nb">Box</span><span class="o">&lt;</span><span class="k">dyn</span> <span class="n">Error</span><span class="o">&gt;&gt;</span> <span class="p">{</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">deck</span> <span class="o">=</span> <span class="nn">deck</span><span class="p">::</span><span class="nn">Deck</span><span class="p">::</span><span class="nf">new</span><span class="p">(</span><span class="n">config</span><span class="py">.cards</span><span class="p">);</span>

    <span class="nd">println!</span><span class="p">(</span><span class="s">"Welcome to FlashCards!"</span><span class="p">);</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Type </span><span class="se">\"</span><span class="s">quit</span><span class="se">\"</span><span class="s"> to exit the application."</span><span class="p">);</span>
    <span class="k">loop</span> <span class="p">{</span>
        <span class="n">deck</span><span class="nf">.draw_hand</span><span class="p">();</span>
        <span class="nd">println!</span><span class="p">(</span><span class="s">"Drawing a fresh hand of {} cards..."</span><span class="p">,</span> <span class="n">deck</span><span class="nf">.hand_count</span><span class="p">());</span>
        <span class="k">while</span> <span class="k">let</span> <span class="nf">Some</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">=</span> <span class="n">deck</span><span class="nf">.next_card</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="nf">show_card</span><span class="p">(</span><span class="o">&amp;</span><span class="n">card</span><span class="p">,</span> <span class="n">config</span><span class="py">.attempts_before_wrong</span><span class="p">)</span><span class="nf">.is_none</span><span class="p">()</span> <span class="p">{</span>
                <span class="nd">println!</span><span class="p">(</span><span class="s">"Quitting application"</span><span class="p">);</span>
                <span class="k">return</span> <span class="nf">Ok</span><span class="p">(());</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">deck</span><span class="nf">.increase_level_pool</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">show_card</code> function displays the <code class="language-plaintext highlighter-rouge">Flashcard</code> clue and then tries to get the answer from the player. If a wrong answer is provided, additional attempts are allowed until the maximum is reached. At that point, the correct answer is supplied to the user and the next card is displayed.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// engine.rs</span>
<span class="k">fn</span> <span class="nf">show_card</span><span class="p">(</span><span class="n">card</span><span class="p">:</span> <span class="o">&amp;</span><span class="k">crate</span><span class="p">::</span><span class="n">FlashCard</span><span class="p">,</span> <span class="k">mut</span> <span class="n">attempts</span><span class="p">:</span> <span class="nb">usize</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Option</span><span class="o">&lt;</span><span class="nb">bool</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="nd">print!</span><span class="p">(</span><span class="s">"{}: "</span><span class="p">,</span> <span class="n">card</span><span class="py">.clue_side</span><span class="p">);</span>
    <span class="k">loop</span> <span class="p">{</span>
        <span class="k">match</span> <span class="nf">get_input</span><span class="p">()</span><span class="nf">.as_str</span><span class="p">()</span> <span class="p">{</span>
            <span class="s">"quit"</span> <span class="k">=&gt;</span> <span class="k">return</span> <span class="nb">None</span><span class="p">,</span>
            <span class="n">s</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="n">card</span><span class="py">.answer_side</span> <span class="k">=&gt;</span> <span class="p">{</span>
                <span class="nd">println!</span><span class="p">(</span><span class="s">"Correct!"</span><span class="p">,);</span>
                <span class="k">return</span> <span class="nf">Some</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">_</span> <span class="k">=&gt;</span> <span class="p">{</span>
                <span class="n">attempts</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
                <span class="k">if</span> <span class="n">attempts</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">{</span>
                    <span class="nd">println!</span><span class="p">(</span><span class="s">"Incorrect. Try again"</span><span class="p">);</span>
                    <span class="nd">print!</span><span class="p">(</span><span class="s">"{}: "</span><span class="p">,</span> <span class="n">card</span><span class="py">.clue_side</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nd">println!</span><span class="p">(</span>
                        <span class="s">"Incorrect. The correct answer was: </span><span class="se">\"</span><span class="s">{}</span><span class="se">\"</span><span class="s">"</span><span class="p">,</span>
                        <span class="n">card</span><span class="py">.answer_side</span>
                    <span class="p">);</span>
                    <span class="k">return</span> <span class="nf">Some</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Finally the helper function <code class="language-plaintext highlighter-rouge">get_input</code> is used to eliminate some nesting and make the code more readable. It clears the buffer and reads the user’s input. That input could be dirty or nonsensical so some minimal sanitization is done and checked for length. If there is no input, a prompt is provided to encourage more input.</p> <div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// engine.rs</span>
<span class="k">fn</span> <span class="nf">get_input</span><span class="p">()</span> <span class="k">-&gt;</span> <span class="nb">String</span> <span class="p">{</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">input</span> <span class="o">=</span> <span class="nn">String</span><span class="p">::</span><span class="nf">new</span><span class="p">();</span>
    <span class="nn">std</span><span class="p">::</span><span class="nn">io</span><span class="p">::</span><span class="nf">stdout</span><span class="p">()</span><span class="nf">.flush</span><span class="p">()</span><span class="nf">.expect</span><span class="p">(</span><span class="s">"Flush failed"</span><span class="p">);</span>
    <span class="k">while</span> <span class="nn">std</span><span class="p">::</span><span class="nn">io</span><span class="p">::</span><span class="nf">stdin</span><span class="p">()</span><span class="nf">.read_line</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">input</span><span class="p">)</span><span class="nf">.is_ok</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">input</span> <span class="o">=</span> <span class="n">input</span><span class="nf">.trim</span><span class="p">()</span><span class="nf">.to_string</span><span class="p">();</span>
        <span class="k">if</span> <span class="o">!</span><span class="n">input</span><span class="nf">.is_empty</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">input</span><span class="nf">.clear</span><span class="p">();</span>
        <span class="nd">println!</span><span class="p">(</span><span class="s">"Please provide an answer or </span><span class="se">\"</span><span class="s">quit</span><span class="se">\"</span><span class="s"> to exit the application."</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">input</span>
<span class="p">}</span>
</code></pre></div></div> <p>That’s it! All the pieces are in place to run and play the game.</p> <h2 id="try-it-out">Try It Out</h2> <p>I have created a CodeSandbox which follows the content so far and allows readers to try the game out. Once the CodeSandbox is opened, you have the option of signing in and making edits and trying different things. Modifications are automatically saved during context switches from file-to-file or when the Ctrl+s keyboard shortcut is used. Once a change to any of the source files is detected, the <code class="language-plaintext highlighter-rouge">cargo run</code> command will be executed and the game can be played.</p> <p><a href="https://codesandbox.io/p/devbox/flashcards-project-functionality-dtxs89?file=%2Fsrc%2Fmain.rs&amp;embed=1" rel="external nofollow noopener" target="_blank"><img src="https://codesandbox.io/static/img/play-codesandbox.svg" alt="Edit flashcards-project-functionality"></a></p> <h2 id="summary">Summary</h2> <ul> <li>The <code class="language-plaintext highlighter-rouge">serde</code> crate makes serialization and deserialization with files very easy to accomplish.</li> <li>The <code class="language-plaintext highlighter-rouge">random</code> crate provides an excellent helper function to randomize a slice.</li> <li>Working with user supplied data is messy and extra care should be taken to sanitize and validate it.</li> </ul> <h2 id="additional-resources">Additional Resources</h2> <ul> <li><a href="https://docs.rs/rand/latest/rand/" rel="external nofollow noopener" target="_blank">Crate rand</a></li> <li><a href="https://docs.rs/serde/latest/serde/" rel="external nofollow noopener" target="_blank">Crate serde</a></li> <li><a href="https://docs.rs/serde_yaml/latest/serde_yaml/" rel="external nofollow noopener" target="_blank">Crate serde_yaml</a></li> <li><a href="https://blog.logrocket.com/comparing-random-number-generators-rust/" rel="external nofollow noopener" target="_blank">Comparing random number generators in Rust</a></li> <li><a href="https://parsiya.net/blog/2022-10-16-yaml-wrangling-with-rust/" rel="external nofollow noopener" target="_blank">YAML Wrangling with Rust</a></li> </ul> </article><div id="giscus_thread" style="max-width: 1280px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"aven-arlington/aven-arlington.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Aven Arlington. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with a heavily modified <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: January 27, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>